<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Berg10 - Administration Center</title>
	<meta name="description" content="Berg10 Administration Center" />
	<meta name="keywords" content="Berg10" />
	<meta name="author" content="Cenacle Research" />
	<link rel="shortcut icon" href="../favicon.ico">

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/g/normalize,bootstrap@3.3.5(css/bootstrap.min.css)">	
</head>
<body>	
	<div id="authContainer"></div>
	<div class="container"></div><!-- /container -->
	
	<!-- Begin Overlay -->
	<div class="overlay overlay-scale">
		<link rel="stylesheet" type="text/css" href="css/bootloader.css" />
		<nav>Initializing the system ...</nav>
		<script src="https://cdn.jsdelivr.net/g/modernizr,classie,jquery@2.1.4,bootstrap@3.3.5,lodash,eventemitter"></script>
		<script>
			transEndEventNames = {
				'WebkitTransition': 'webkitTransitionEnd',
				'MozTransition': 'transitionend',
				'OTransition': 'oTransitionEnd',
				'msTransition': 'MSTransitionEnd',
				'transition': 'transitionend'
			},
			transEndEventName = transEndEventNames[ Modernizr.prefixed( 'transition' ) ],
			support = { transitions : Modernizr.csstransitions };

			function toggleOverlay(overlay) {
				if( classie.has( overlay, 'open' ) ) {
					classie.remove( overlay, 'open' );
					classie.add( overlay, 'closing' );
					var onEndTransitionFn = function( ev ) {
						if( support.transitions ) {
							if( ev.propertyName !== 'visibility' ) return;
							this.removeEventListener( transEndEventName, onEndTransitionFn );
						}
						classie.remove( overlay, 'closing' );
					};
					if( support.transitions ) {
						overlay.addEventListener( transEndEventName, onEndTransitionFn );
					}
					else {
						onEndTransitionFn();
					}
				}
				else if( !classie.has( overlay, 'closing' ) ) {
					classie.add( overlay, 'open' );
				}
			}

			// smooth statu report system
			var statuses = [];
			var intervalTimer = null;
			function pushStatusText(statusText) {
				if (statuses.length <= 0)
					intervalTimer = setInterval(setStatusText, 1000);
				statuses.push(statusText);			
				if (statuses.length > 1)
					setTimeout(setStatusText, 1000 / statuses.length);
			}
			function setStatusText() {
				if (statuses.length <= 0) {
					clearInterval(intervalTimer);
					return;
				}
				overlayNav.innerHTML = statuses.shift();
				if (statuses.length > 1)
					setTimeout(setStatusText, 1000/statuses.length);
			}
		</script>
	</div> <!-- /Overlay -->

	<script type="text/javascript">
		var overlay = document.querySelector( 'div.overlay' );
		var overlayNav = document.querySelector('div.overlay nav');
		toggleOverlay(overlay);		
	
		$(document).ready(function () {
			pushStatusText("Berg10 - Launching remote probes ...");

			// prepare ajax
			$.ajaxSetup({
				cache: true, async: true, ifModified: false, // better to leave ifModified as false (cache: true should be enough)
			});

			$('#authContainer').load("ajax/authHandler.html", function (response, status, xhr) {
				var statusText = "Berg10 - remote galaxy spotted ...";
				if (xhr.status >= 400)
					statusText = "Remote probe failed. Is the server running?";
				pushStatusText(statusText);
			});
		});
	</script>
</body>
</html>
